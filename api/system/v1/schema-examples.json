{
  "os_config_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "操作系统配置",
    "type": "object",
    "properties": {
      "network": {
        "title": "网络配置",
        "type": "object",
        "properties": {
          "interfaces": {
            "title": "网络接口",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "title": "接口名称",
                  "type": "string",
                  "description": "网络接口名称，如 eth0, ens33",
                  "examples": ["eth0", "ens33", "wlan0"]
                },
                "ipv4": {
                  "title": "IPv4 配置",
                  "type": "object",
                  "properties": {
                    "address": {
                      "title": "IP 地址",
                      "type": "string",
                      "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}/[0-9]{1,2}$",
                      "description": "IPv4 地址和子网掩码，如 192.168.1.100/24"
                    },
                    "gateway": {
                      "title": "网关地址",
                      "type": "string",
                      "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$",
                      "description": "IPv4 网关地址"
                    },
                    "dhcp_enabled": {
                      "title": "启用 DHCP",
                      "type": "boolean",
                      "default": false
                    }
                  }
                },
                "mtu": {
                  "title": "MTU 大小",
                  "type": "integer",
                  "minimum": 68,
                  "maximum": 9000,
                  "default": 1500
                }
              },
              "required": ["name"]
            }
          }
        }
      },
      "dns": {
        "title": "DNS 配置",
        "type": "object",
        "properties": {
          "nameservers": {
            "title": "DNS 服务器",
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$",
              "description": "DNS 服务器 IP 地址"
            },
            "minItems": 1,
            "maxItems": 3
          },
          "search_domains": {
            "title": "搜索域",
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9.-]+$"
            }
          }
        }
      },
      "time": {
        "title": "时间配置",
        "type": "object",
        "properties": {
          "timezone": {
            "title": "时区",
            "type": "string",
            "enum": [
              "Asia/Shanghai",
              "Asia/Beijing",
              "UTC",
              "America/New_York",
              "Europe/London"
            ],
            "default": "Asia/Shanghai"
          },
          "ntp": {
            "title": "NTP 配置",
            "type": "object",
            "properties": {
              "enabled": {
                "title": "启用 NTP",
                "type": "boolean",
                "default": true
              },
              "servers": {
                "title": "NTP 服务器",
                "type": "array",
                "items": {
                  "type": "string",
                  "description": "NTP 服务器地址"
                },
                "default": ["ntp1.aliyun.com", "ntp2.aliyun.com"]
              }
            }
          }
        }
      }
    }
  },
  "hardware_config_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "硬件配置",
    "type": "object",
    "properties": {
      "serial_ports": {
        "title": "串口配置",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "device_path": {
              "title": "设备路径",
              "type": "string",
              "pattern": "^/dev/tty[A-Za-z0-9]+$",
              "examples": ["/dev/ttyS0", "/dev/ttyUSB0"]
            },
            "display_name": {
              "title": "显示名称",
              "type": "string",
              "description": "用户友好的显示名称，如 COM1"
            },
            "parameters": {
              "title": "串口参数",
              "type": "object",
              "properties": {
                "baud_rate": {
                  "title": "波特率",
                  "type": "integer",
                  "enum": [9600, 19200, 38400, 57600, 115200, 230400, 460800, 921600],
                  "default": 115200
                },
                "data_bits": {
                  "title": "数据位",
                  "type": "integer",
                  "enum": [5, 6, 7, 8],
                  "default": 8
                },
                "stop_bits": {
                  "title": "停止位",
                  "type": "integer",
                  "enum": [1, 2],
                  "default": 1
                },
                "parity": {
                  "title": "校验位",
                  "type": "string",
                  "enum": ["none", "odd", "even", "mark", "space"],
                  "default": "none"
                }
              }
            },
            "mode": {
              "title": "串口模式",
              "type": "string",
              "enum": ["rs232", "rs485", "rs422"],
              "default": "rs232"
            },
            "rs485_config": {
              "title": "RS485 配置",
              "type": "object",
              "properties": {
                "enabled": {
                  "title": "启用 RS485",
                  "type": "boolean",
                  "default": false
                },
                "rts_on_send": {
                  "title": "发送时 RTS 高电平",
                  "type": "boolean",
                  "default": true
                },
                "delay_rts_before_send": {
                  "title": "发送前 RTS 延迟（微秒）",
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 1000000,
                  "default": 0
                }
              },
              "dependencies": {
                "enabled": {
                  "properties": {
                    "enabled": {
                      "const": true
                    }
                  }
                }
              }
            },
            "transparent_config": {
              "title": "透传配置",
              "type": "object",
              "properties": {
                "enabled": {
                  "title": "启用透传",
                  "type": "boolean",
                  "default": false
                },
                "protocol": {
                  "title": "透传协议",
                  "type": "string",
                  "enum": ["tcp", "udp", "websocket"],
                  "default": "tcp"
                },
                "listen_port": {
                  "title": "监听端口",
                  "type": "integer",
                  "minimum": 1024,
                  "maximum": 65535,
                  "default": 8080
                }
              }
            }
          },
          "required": ["device_path", "parameters"]
        }
      },
      "udev_rules": {
        "title": "Udev 规则",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "title": "规则名称",
              "type": "string",
              "description": "规则的唯一标识名称"
            },
            "subsystem": {
              "title": "子系统",
              "type": "string",
              "enum": ["tty", "usb", "block", "net"],
              "description": "设备子系统类型"
            },
            "attributes": {
              "title": "设备属性",
              "type": "object",
              "properties": {
                "idVendor": {
                  "title": "供应商 ID",
                  "type": "string",
                  "pattern": "^[0-9a-fA-F]{4}$",
                  "description": "4位十六进制供应商 ID"
                },
                "idProduct": {
                  "title": "产品 ID",
                  "type": "string",
                  "pattern": "^[0-9a-fA-F]{4}$",
                  "description": "4位十六进制产品 ID"
                }
              }
            },
            "symlink": {
              "title": "符号链接",
              "type": "string",
              "description": "创建的符号链接名称"
            }
          },
          "required": ["name", "subsystem", "symlink"]
        }
      }
    }
  },
  "ui_schema_examples": {
    "network_interface_form": {
      "ui:order": ["name", "ipv4", "mtu"],
      "name": {
        "ui:placeholder": "请输入接口名称，如 eth0"
      },
      "ipv4": {
        "ui:title": "IPv4 配置",
        "address": {
          "ui:placeholder": "192.168.1.100/24"
        },
        "gateway": {
          "ui:placeholder": "192.168.1.1"
        },
        "dhcp_enabled": {
          "ui:widget": "checkbox",
          "ui:title": "自动获取 IP 地址 (DHCP)"
        }
      },
      "mtu": {
        "ui:widget": "updown"
      }
    },
    "serial_port_form": {
      "ui:order": ["device_path", "display_name", "parameters", "mode", "rs485_config", "transparent_config"],
      "device_path": {
        "ui:placeholder": "/dev/ttyS0"
      },
      "display_name": {
        "ui:placeholder": "COM1"
      },
      "parameters": {
        "ui:title": "串口参数",
        "baud_rate": {
          "ui:widget": "select"
        },
        "data_bits": {
          "ui:widget": "radio"
        },
        "stop_bits": {
          "ui:widget": "radio"
        },
        "parity": {
          "ui:widget": "select"
        }
      },
      "mode": {
        "ui:widget": "radio"
      },
      "rs485_config": {
        "ui:title": "RS485 配置",
        "ui:collapsible": true,
        "enabled": {
          "ui:widget": "checkbox"
        }
      },
      "transparent_config": {
        "ui:title": "透传配置",
        "ui:collapsible": true,
        "enabled": {
          "ui:widget": "checkbox"
        }
      }
    }
  }
} 